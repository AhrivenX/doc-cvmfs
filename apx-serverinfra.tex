\chapter{\cvmfs\ Server Infrastructure}
\label{apx:serverinfrastructure}

This is trying to be a full documentation of a \cvmfs\ server setup including the infrastructure necessary for an individual repository.
It is highly recommended to first consult Section~\ref{sct:repoanatomy} for a more general overview of the involved directory structure.

\section{Prerequisites}
A \cvmfs\ server installation depends on some environment setup and tools to be in place:
\begin{itemize}
\item \aufs\ support in the kernel (see Section~\ref{sct:customkernelinstall})
\item Backend storage location available through HTTP
\item \textbf{cvmfs} and \textbf{cvmfs-server} packages installed
\end{itemize}

\section{Local Backend Storage Infrastructure}
\cvmfs\ stores the entire repository content (file content and meta-data catalogs) into a content addressable storage (CAS).
This storage can either be a file system at \texttt{/srv/cvmfs} or an S3 compatible key-value storage system (see Section~\ref{sct:s3storagesetup} for details).
In the former case the contents of \texttt{/srv/cvmfs} are as follows:

\LTXtable{\textwidth}{figures/tablocalstorageanatomy.tex}
\pagebreak

\section{Server Spool Area of a Repository (Stratum0)}
The spool area of a repository contains transaction infrastructure and scratch area of a Stratum0 or specifically a release manager machine installation.
It is always located inside \texttt{/var/spool/cvmfs} with directories for individual repositories.
Note that the data volume of the spool area can grow very large for massive repository updates since it contains the writable AUFS branch and a \cvmfs\ client cache directory.

\LTXtable{\textwidth}{figures/tabrepospoolanatomy.tex}
